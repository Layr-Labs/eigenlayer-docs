---
title: Public Deployment
sidebar_position: 2
---

# Deploy Guide

This guide will show you how to deploy an Optimism Plasma rollup on a public Ethereum network, using an EigenDA proxy instance for secure communication with the DA. 

## EigenDA Proxy
EigenDA proxy is a sidecar server which implements the optimism plasma server [spec](https://specs.optimism.io/experimental/plasma.html). Instructions for spawning and running the service can be found [here](https://github.com/Layr-Labs/eigenda-proxy). 

Instructions for building and running the service can be found [here](https://github.com/Layr-Labs/eigenda-proxy?tab=readme-ov-file#running-locally).

### Security
When reading and writing, the proxy verifies the respective raw batch data against the commitment to ensure tamper resistance. This means a sequencer would never accept an invalid commitment when publishing to DA.

The following verifications are ran to verify the commitment generated by EigenDA to ensure a more trustless interaction:
1. kzg commitments are verified by regenerating commitments and asserting equivalence 
2. blob length is canonical provided encoded length bytes

## Deploying with OP Plasma
Since we don't actually fork Optimism for this integration, we recommend utilizing the existing deployment procedure as defined within OP's [tutorial](https://docs.optimism.io/builders/chain-operators/tutorials/create-l2-rollup).


### Configuration

#### OP Node Derivation
It is recommended to set the `DaChallengeWindow` and `DaResolveWindow` per OP Node in best accordance to the finality constraints of ephemeral EigenDA blobs (i.e, 14 days). We can define sync origin for where to start [deriving](https://specs.optimism.io/experimental/plasma.html#derivation) from Plasma DA via the following function:
```
starting_point = latest_l1_block - (challenge_window_size + resolve_window_size + sequencer_window_size)
```

Assuming `12 sec / block` for a 14 day window, we can compute the `eigenda_sync_start` as follows:
```
max_eigenda_sync_start = (60 sec/minute * 60 min/hour * 24 hour/day * 14 days) / 12
max_eigenda_sync_start = 100,800 blocks
```

To ensure adequate safety and faster [finality](https://specs.optimism.io/experimental/plasma.html#safety-and-finality), we recommend setting the `DaChallengeWindow + DaResolveWindow < 100,800`. Since this value affects `Final` head, setting this sum to  lower value (<1000 blocks) is most ideal for efficient operation.


These values can be manually set in the respective OP Node `rollup.json` configuration; e.g:
```json
{
  "plasma_config": {
    "da_challenge_contract_address": "0x0000000000000000000000000000000000000000",
    "da_commitment_type": "GenericCommitment",
    "da_challenge_window": 400,
    "da_resolve_window": 300
  }
}
```

#### Proxy Communication

*OP Node*
The following env config values should be set to ensure proper OP Node <-> Proxy communication:
- `OP_NODE_PLASMA_ENABLED=true`
- `OP_NODE_PLASMA_DA_SERVICE=true`
- `OP_NODE_PLASMA_VERIFY_ON_READ=false`
- `OP_NODE_PLASMA_DA_SERVER={EIGENDA_PROXY_URL}`

*OP Batcher*
The following env config values should be set accordingly to ensure proper OP Batcher <-> Proxy communication:
- `OP_BATCHER_PLASMA_ENABLED=true`
- `OP_BATCHER_PLASMA_DA_SERVICE=true`
- `OP_BATCHER_PLASMA_VERIFY_ON_READ=false`
- `OP_BATCHER_PLASMA_DA_SERVER={EIGENDA_PROXY_URL}`


## Challenge Contract
One new component of OP Plasma is the addition of a [challenge contract](https://specs.optimism.io/experimental/plasma.html#data-availability-challenge-contract) which allows altruistic actors to challenge commitments posted to the sequencer inbox. This functionality is currently unsupported for EigenDA.

Its worth noting the security model doesn't change since the OP Sequencer is a trusted entity that unilaterally controls the liveness and security of the L2 chain. In the case where the sequencer posts an invalid commitment that results then any verifier nodes syncing from EigenDA would halt given they'd be incapable of inspecting the batch. This is analogous to the same DoS vector where the sequencer arbitrarily stops producing batches. 